seq(1994:2016)
seq(1994:2016,1)
seq(1994,2016)
CPUE2018<-data.frame(c("Year"=seq(1994,2016),"ShallowCPUE"=c(3.04,3.16,3.37,3.69,3.79,4.12,NA,NA,NA,NA,11.46,12.13,10.38,10.21,8.37,7.34,8.61,8.41,7.81,9.08,9.25,10.65
),"DeepCPUE"=c(0.32,0.20,0.15,0.22,0.22,0.20,0.19,0.25,0.23,0.26,0.22,0.24,0.23,0.22,0.23,0.22,0.19,0.22,0.22,0.25,0.27,0.25)))
View(CPUE2018)
CPUE2018<-data.frame("Year"=seq(1994,2016),"ShallowCPUE"=c(3.04,3.16,3.37,3.69,3.79,4.12,NA,NA,NA,NA,11.46,12.13,10.38,10.21,8.37,7.34,8.61,8.41,7.81,9.08,9.25,10.65
),"DeepCPUE"=c(0.32,0.20,0.15,0.22,0.22,0.20,0.19,0.25,0.23,0.26,0.22,0.24,0.23,0.22,0.23,0.22,0.19,0.22,0.22,0.25,0.27,0.25))
CPUE2018<-data.frame("Year"=seq(1995,2016),"ShallowCPUE"=c(3.04,3.16,3.37,3.69,3.79,4.12,NA,NA,NA,NA,11.46,12.13,10.38,10.21,8.37,7.34,8.61,8.41,7.81,9.08,9.25,10.65
),"DeepCPUE"=c(0.32,0.20,0.15,0.22,0.22,0.20,0.19,0.25,0.23,0.26,0.22,0.24,0.23,0.22,0.23,0.22,0.19,0.22,0.22,0.25,0.27,0.25))
View(CPUE2018)
CPUE2023<-data.frame("Year"=seq(1995,2021),"ShallowCPUE"=c(6.36,6.85,7.80,7.85,7.69,8.07,NA,NA,NA,NA,15.25,16.87,14.16,13.20,10.69,9.74,10.69,9.28,9.31,9.51,10.61,12.29,12.19,10.22,8.86,9.14,7.20),
"DeepCPUE"=c(0.30,0.19,0.12,0.17,0.15,0.13,0.14,0.18,0.16,0.21,0.15,0.16,0.15,0.14,0.15,0.13,0.11,0.13,0.13,0.17,0.18,0.15,0.16,0.16,0.13,0.10,0.11))
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=DeepCPUE),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE),data=CPUE2023,color="grey50",shape=15)+
geom_point(aes(x=Year,y=DeepCPUE),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=DeepCPUE),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE),data=CPUE2023,color="grey50")+
geom_line(aes(x=Year,y=DeepCPUE),data=CPUE2023,color="grey50")+
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=DeepCPUE),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE),data=CPUE2023,color="grey50",shape=15)+
geom_point(aes(x=Year,y=DeepCPUE),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=DeepCPUE),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE),data=CPUE2023,color="grey50")+
geom_line(aes(x=Year,y=DeepCPUE),data=CPUE2023,color="grey50")
library(ggplot2)
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=DeepCPUE),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE),data=CPUE2023,color="grey50",shape=15)+
geom_point(aes(x=Year,y=DeepCPUE),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=DeepCPUE),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE),data=CPUE2023,color="grey50")+
geom_line(aes(x=Year,y=DeepCPUE),data=CPUE2023,color="grey50")
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50")+
geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50")
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",shape=17)+
#  geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50",shape=15)+
#  geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",linetype="dashed")+
# geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50")+
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",shape=17)+
#  geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50",shape=15)+
#  geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",linetype="dashed")+
# geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50")
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",shape=17)+
#  geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50",shape=15)+
#  geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",linetype="dashed")+
# geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50")
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",shape=17)+
#  geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2023,color="grey50",shape=15)+
#  geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",linetype="dashed")+
# geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2023,color="grey50")
ggplot()+
#geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",shape=17)+
#geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50",shape=15)+
#  geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",linetype="dashed")+
# geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE)),data=CPUE2023,color="grey50")+
geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50")
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2023,color="grey50")+
theme_bw()+
ylab("Deep CPUE")
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2023,color="grey50")+
theme_bw()+
ylab("Shallow-set CPUE")
ggplot()+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCPUE/mean(ShallowCPUE,na.rm=TRUE)),data=CPUE2023,color="grey50")+
theme_bw()+
ylab("Shallow-set Standardized CPUE")
CPUE2018[1:6,2]/mean(CPUE2018[1:6,2]
)
CPUE2018$ShallowCentered<-c(CPUE2018[1:6,2]/mean(CPUE2018[1:6,2]),NA,NA,NA,NA,CPUE2018[11:22,2]/mean(CPUE2018[11:22,2]))
CPUE2023$ShallowCentered<-c(CPUE2023[1:6,2]/mean(CPUE2023[1:6,2]),NA,NA,NA,NA,CPUE2023[11:27,2]/mean(CPUE2023[11:27,2]))
ggplot()+
geom_point(aes(x=Year,y=ShallowCentered),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCentered),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCentered),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCentered),data=CPUE2023,color="grey50")+
theme_bw()+
ylab("Shallow-set Standardized CPUE")
ggplot()+
geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50")+
theme_bw()+
ylab("Deep-set Standardized CPUE")
png("ShallowCompared.png",height=4,width=8,units="in",res=200)
ggplot()+
geom_point(aes(x=Year,y=ShallowCentered),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=ShallowCentered),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=ShallowCentered),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=ShallowCentered),data=CPUE2023,color="grey50")+
theme_bw()+
ylab("Shallow-set Standardized CPUE")
dev.off()
png("DeepCompared.png",height=4,width=8,units="in",res=200)
ggplot()+
geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",shape=17)+
geom_point(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50",shape=15)+
geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2018,color="black",linetype="dashed")+
geom_line(aes(x=Year,y=DeepCPUE/mean(DeepCPUE)),data=CPUE2023,color="grey50")+
theme_bw()+
ylab("Deep-set Standardized CPUE")
dev.off()
#| echo: false
#| label: fig-FLRsmoother
#| fig-cap: "Plot of CPUE index by fleet with a simple loess smoother fit to each time series. This provides information on the general trend of the indices considered for inclusion in the model and identifies potential conflict between indices."
source(file.path(base.dir,"Rscripts","004_CPUE_Comparisons.R"))
#| echo: false
#| label: fig-dataplot
#| fig-cap: "Catch, CPUE index, and size composition data included in the 2023 NP swordfish stock assessment. The size of the bubble indicates the relative number of observations available."
#| fig-width: 16
#| fig-height: 10
#| fig-alt: "Plot of the available data for the 2023 North Pacific Swordfish assessment by year."
base.dir<-"C://users//michelle.sculley//documents//2023 SWO ASSESS"
#| echo: false
#| label: fig-FLRsmoother
#| fig-cap: "Plot of CPUE index by fleet with a simple loess smoother fit to each time series. This provides information on the general trend of the indices considered for inclusion in the model and identifies potential conflict between indices."
source(file.path(base.dir,"Rscripts","004_CPUE_Comparisons.R"))
source(file.path(base.dir,"Rscripts","001_LoadModel.R"))
#| echo: false
#| label: fig-FLRsmoother
#| fig-cap: "Plot of CPUE index by fleet with a simple loess smoother fit to each time series. This provides information on the general trend of the indices considered for inclusion in the model and identifies potential conflict between indices."
source(file.path(base.dir,"Rscripts","004_CPUE_Comparisons.R"))
Rmisc::multiplot(cpue1,cpue2, cols = 2)
#| echo: false
#| label: fig-FLRsmoother
#| fig-cap: "Plot of CPUE index by fleet with a simple loess smoother fit to each time series. This provides information on the general trend of the indices considered for inclusion in the model and identifies potential conflict between indices."
source(file.path(base.dir,"Rscripts","004_CPUE_Comparisons.R"))
Rmisc::multiplot(cpue1,cpue2, cols = 2)
file.path(current.dir, "Retros","retro-")
list.files(file.path(current.dir, "Retros","retros-0"))
list.files(file.path(current.dir, "Retros","retros-0")
length(list.files(file.path(current.dir, "Retros","retros-0"),pattern="Report"))
file.path(current.dir, "Retros","retros-0")
list.files(file.path(current.dir, "Retros","retros-0"),pattern="Report")
list.files(file.path(current.dir, "Retros","retros-0"),pattern="Report.sso"))
list.files(file.path(current.dir, "Retros","retros-0"),pattern="Report.sso")
dirname.base = current.dir
#  file.path(current.dir,"Diagnostics","Retros")
# Names of DAT and CONTROL files
DAT = data.file.name
CTL =  ctl.file.name
# # Step 2. Identify the directory where a completed model run is located
dirname.completed.model.run <- dirname.base
# dirname.completed.model.run
#
# # Step 3. Create a subdirectory for the Retrospectives
dirname.Retrospective <- paste0(dirname.base,'/Retros')
dir.create(path=dirname.Retrospective, showWarnings = TRUE, recursive = TRUE)
setwd(dirname.Retrospective)
ctl.file.name<-"swo2023_v007.ctl"
# dirname.completed.model.run
#
# # Step 3. Create a subdirectory for the Retrospectives
dirname.Retrospective <- paste0(dirname.base,'/Retros')
setwd(dirname.Retrospective)
if(!file.exists(file.path(current.dir, "Retros"))){
stop("No retrospecitve runs were found. Please change Do_Retros = TRUE first.")
}
if(length(list.files(file.path(current.dir, "Retros","retros-0"),pattern="Report.sso")) < 1){
stop("No retrospecitve runs were found. Please change Do_Retros = TRUE first.")
}
# Step 6. Read "SS_doRetro" output
retroModels <- SSgetoutput(dirvec=file.path(dirname.Retrospective, paste("retro",start.retro:-end.retro,sep="")))
start.retro <- 0
end.retro   <- 5
# Step 6. Read "SS_doRetro" output
retroModels <- SSgetoutput(dirvec=file.path(dirname.Retrospective, paste("retro",start.retro:-end.retro,sep="")))
# Step 6. Read "SS_doRetro" output
retroModels <- SSgetoutput(dirvec=file.path(dirname.Retrospective, paste("retro",start.retro:-end.retro,sep="")))
retroSummary <- SSsummarize(retroModels)
endyrvec <- retroSummary$endyrs + 0:-5
sspar(mfrow=c(2,2),plot.cex = 0.9)
SSplotRetro(retroSummary,forecast = F,add=T,showrho = F,subplots = c("SSB", "F")[1]) # SSB
SSplotRetro(retroSummary,forecast = F,add=T,showrho = F,subplots = c("SSB", "F")[2],legend = F) # F
SSplotRetro(retroSummary,xmin=2000,forecastrho = T,add=T,legend = F)
SSplotRetro(retroSummary,xmin=2000,forecastrho = T,add=T,legend = F,subplots="F")
Help<-SSplotRetro(retroSummary,forecast = F,add=T,showrho = F,subplots = c("SSB", "F")[1])
Help
SSplotRetro(retroSummary,forecast = F,showrho = F,subplots = c("SSB", "F")[1]) # SSB
SSplotRetro(retroSummary,forecast = F,add=T,showrho = F,subplots = c("SSB", "F")[2],legend = F) # F
SSplotRetro(retroSummary,xmin=2000,forecastrho = T,add=T,legend = F)
SSplotRetro(retroSummary,xmin=2000,forecastrho = T,add=T,legend = F,subplots="F")
sspar(mfrow=c(2,2),plot.cex = 0.9)
SSplotRetro(retroSummary,forecast = F,showrho = F,subplots = c("SSB", "F")[1]) # SSB
SSplotRetro(retroSummary,forecast = F,add=T,showrho = F,subplots = c("SSB", "F")[2],legend = F) # F
SSplotRetro(retroSummary,xmin=2000,forecastrho = T,add=T,legend = F)
SSplotRetro(retroSummary,xmin=2000,forecastrho = T,add=T,legend = F,subplots="F")
dev.off()
sspar(mfrow=c(2,2),plot.cex = 0.9)
SSplotRetro(retroSummary,forecast = F,showrho = F,subplots = c("SSB", "F")[1]) # SSB
SSplotRetro(retroSummary,forecast = F,add=T,showrho = F,subplots = c("SSB", "F")[2],legend = F) # F
SSplotRetro(retroSummary,xmin=2000,forecastrho = T,add=T,legend = F)
SSplotRetro(retroSummary,xmin=2000,forecastrho = T,add=T,legend = F,subplots="F")
